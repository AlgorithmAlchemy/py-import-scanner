# Архитектура Python Import Parser

## Обзор

Проект был рефакторен с монолитной архитектуры на модульную с четким разделением ответственности и соблюдением принципов SOLID.

## Структура проекта

```
py_import_parser/
├── src/                          # Основной код приложения
│   ├── core/                     # Бизнес-логика
│   │   ├── __init__.py
│   │   ├── interfaces.py         # Интерфейсы и контракты
│   │   ├── configuration.py      # Конфигурация приложения
│   │   ├── import_parser.py      # Парсер импортов
│   │   ├── project_analyzer.py   # Анализатор проектов
│   │   ├── file_scanner.py       # Сканер файлов
│   │   ├── data_exporter.py      # Экспорт данных
│   │   └── scan_service.py       # Главный сервис
│   ├── gui/                      # Пользовательский интерфейс
│   │   ├── main_window.py        # Главное окно
│   │   ├── stats_window.py       # Окно статистики
│   │   └── chart_windows.py      # Окна с графиками
│   └── main_refactored.py        # Обновленная точка входа
├── tests/                        # Тесты
├── config.json                   # Конфигурационный файл
└── requirements.txt              # Зависимости
```

## Принципы архитектуры

### 1. Dependency Injection
Все зависимости инжектируются через конструкторы, что обеспечивает:
- Легкость тестирования
- Слабое связывание компонентов
- Возможность замены реализаций

### 2. Interface Segregation
Каждый модуль имеет четко определенный интерфейс:
- `IFileScanner` - сканирование файлов
- `IImportParser` - парсинг импортов
- `IProjectAnalyzer` - анализ проектов
- `IDataExporter` - экспорт данных
- `IConfiguration` - конфигурация

### 3. Single Responsibility
Каждый класс отвечает за одну задачу:
- `ImportParser` - только парсинг импортов
- `ProjectAnalyzer` - только анализ структуры проектов
- `DataExporter` - только экспорт данных

### 4. Open/Closed Principle
Система открыта для расширения, закрыта для модификации:
- Новые форматы экспорта через `IDataExporter`
- Новые парсеры через `IImportParser`
- Новые анализаторы через `IProjectAnalyzer`

## Основные компоненты

### ScanService
Главный координатор, который:
- Управляет процессом сканирования
- Координирует работу всех модулей
- Предоставляет единый API для GUI

### Configuration
Централизованная конфигурация с:
- Загрузкой из JSON файла
- Значениями по умолчанию
- Возможностью динамического обновления

### FileScanner
Оптимизированный сканер с:
- Параллельной обработкой файлов
- Поддержкой разных кодировок
- Фильтрацией по размеру и типу файлов

### ImportParser
Парсер импортов с:
- AST-анализом
- Фильтрацией стандартных библиотек
- Статистикой использования

### ProjectAnalyzer
Анализатор проектов с:
- Определением структуры проектов
- Анализом дат создания
- Группировкой по директориям

### DataExporter
Экспортер данных с поддержкой:
- CSV формата
- JSON формата
- Excel формата
- Текстовых отчетов

## Преимущества новой архитектуры

### 1. Тестируемость
- Каждый компонент можно тестировать изолированно
- Легко создавать моки для зависимостей
- Четкие интерфейсы упрощают unit-тесты

### 2. Расширяемость
- Новые форматы экспорта без изменения существующего кода
- Новые парсеры импортов
- Новые анализаторы проектов

### 3. Поддерживаемость
- Четкое разделение ответственности
- Документированные интерфейсы
- Типизированный код

### 4. Производительность
- Оптимизированная обработка файлов
- Параллельное сканирование
- Кэширование результатов

## Миграция с старой архитектуры

### Для разработчиков:
1. Используйте `ScanService` вместо прямых вызовов функций
2. Настройте конфигурацию через `Configuration`
3. Используйте типизированные данные из `interfaces.py`

### Для пользователей:
1. Запускайте `src/main_refactored.py` вместо `main.py`
2. Конфигурация сохраняется в `config.json`
3. Результаты экспортируются в папку `exports/`

## Конфигурация

Файл `config.json` содержит настройки:
```json
{
  "excluded_libraries": ["os", "sys", "re"],
  "excluded_directories": ["venv", "__pycache__"],
  "max_file_size": 10485760,
  "max_depth": 6,
  "batch_size": 100,
  "max_workers": 4
}
```

## Планы развития

1. **Кэширование** - сохранение результатов сканирования
2. **Плагины** - система плагинов для расширения функциональности
3. **API** - REST API для интеграции с другими системами
4. **База данных** - хранение истории сканирований
5. **Аналитика** - продвинутая аналитика зависимостей
